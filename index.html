<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="auto">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚ - Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ©</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --bg: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
    --surface: rgba(23, 26, 33, 0.95);
    --surface-hover: rgba(30, 35, 45, 0.98);
    --surface-card: rgba(30, 35, 45, 0.7);
    --border: rgba(56, 68, 77, 0.45);
    --border-hover: rgba(56, 68, 77, 0.65);
    --text: #f0f3f6;
    --muted: #a8b3c0;
    --ok: #10b981;
    --warn: #f59e0b;
    --bad: #ef4444;
    --accent: #4f9cf9;
    --accent2: #9d6dfd;
    --number: #8ac8ff;
    --shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
    --shadow2: 0 16px 50px rgba(0, 0, 0, 0.5);
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --card-radius: 22px;
  }
  
  @media (prefers-color-scheme: light) {
    :root {
      --bg: linear-gradient(135deg, #f9fafc 0%, #eef2f6 100%);
      --surface: rgba(255, 255, 255, 0.98);
      --surface-hover: rgba(255, 255, 255, 0.98);
      --surface-card: rgba(255, 255, 255, 0.85);
      --border: rgba(203, 213, 225, 0.75);
      --border-hover: rgba(148, 163, 184, 0.6);
      --text: #1a2035;
      --muted: #64748b;
      --number: #1e40af;
      --shadow: 0 8px 32px rgba(15, 23, 42, 0.15);
      --shadow2: 0 12px 48px rgba(15, 23, 42, 0.2);
    }
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: 'Tajawal', sans-serif;
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
    transition: var(--transition);
  }
  
  .wrap {
    max-width: 1400px;
    margin: 0 auto;
    padding: 24px 16px;
  }
  
  /* Header Styles */
  .header {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    align-items: center;
    justify-content: space-between;
    margin: 0 0 24px;
    padding: 16px 0;
    border-bottom: 1px solid var(--border);
    position: relative;
  }
  
  .logo-container {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  
  .logo {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    box-shadow: var(--shadow);
    color: white;
  }
  
  .logo-text {
    display: flex;
    flex-direction: column;
  }
  
  .site-title {
    margin: 0;
    font-size: 1.8rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .site-subtitle {
    color: var(--muted);
    font-size: 0.9rem;
    font-weight: 500;
    letter-spacing: 0.5px;
  }
  
  /* Controls */
  .controls {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    align-items: center;
  }
  
  .market-status {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--muted);
    box-shadow: 0 0 8px currentColor;
  }
  
  .status-indicator.active {
    background: var(--ok);
    box-shadow: 0 0 12px var(--ok);
  }
  
  .pill {
    padding: 10px 18px;
    border: 1px solid var(--border);
    border-radius: 999px;
    background: var(--surface-card);
    font-weight: 700;
    font-size: 14px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .pill.ok {
    border-color: var(--ok);
    background: rgba(16, 185, 129, 0.15);
  }
  
  .pill.warn {
    border-color: var(--warn);
    background: rgba(245, 158, 11, 0.15);
  }
  
  .pill.bad {
    border-color: var(--bad);
    background: rgba(239, 68, 68, 0.15);
  }
  
  .btn {
    padding: 10px 18px;
    border: 1px solid var(--border);
    border-radius: 14px;
    background: var(--surface-card);
    color: var(--text);
    cursor: pointer;
    font-weight: 600;
    box-shadow: var(--shadow);
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }
  
  .btn:hover {
    background: var(--surface-hover);
    transform: translateY(-3px);
    border-color: var(--border-hover);
    box-shadow: var(--shadow2);
  }
  
  .btn-primary {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: white;
    border: none;
  }
  
  /* Card Styles */
  .card-grid {
    display: grid;
    gap: 24px;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    margin-bottom: 32px;
  }
  
  .card {
    background: var(--surface-card);
    border: 1px solid var(--border);
    border-radius: var(--card-radius);
    padding: 24px;
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
    transition: var(--transition);
  }
  
  .card:hover {
    transform: translateY(-5px);
    border-color: var(--border-hover);
    box-shadow: var(--shadow2);
  }
  
  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }
  
  .card-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text);
  }
  
  .card-icon {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: rgba(79, 156, 249, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
    font-size: 18px;
  }
  
  .card.ok {
    background: rgba(16, 185, 129, 0.1);
    border-color: rgba(16, 185, 129, 0.4);
  }
  
  .card.warn {
    background: rgba(245, 158, 11, 0.1);
    border-color: rgba(245, 158, 11, 0.4);
  }
  
  .card.bad {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.4);
  }
  
  .card-content {
    flex-grow: 1;
  }
  
  .kv {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    margin: 14px 0;
    align-items: center;
  }
  
  .kv-label {
    color: var(--muted);
    font-weight: 500;
    font-size: 0.9rem;
  }
  
  .kv-value {
    font-weight: 600;
    text-align: left;
  }
  
  .center {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  
  .big {
    color: var(--number);
    font-size: 1.8rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    line-height: 1.2;
    max-width: 100%;
    word-break: break-word;
  }
  
  /* Trend Indicators */
  .trend {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 600;
  }
  
  .trend.up {
    background: rgba(16, 185, 129, 0.15);
    color: var(--ok);
  }
  
  .trend.down {
    background: rgba(239, 68, 68, 0.15);
    color: var(--bad);
  }
  
  /* Chart */
  .chart-container {
    background: var(--surface-card);
    border: 1px solid var(--border);
    border-radius: var(--card-radius);
    box-shadow: var(--shadow);
    padding: 20px;
    margin-bottom: 32px;
    transition: var(--transition);
  }
  
  .chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }
  
  .chart-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text);
  }
  
  canvas#priceChart {
    width: 100%;
    height: 380px;
    display: block;
    border-radius: 16px;
  }
  
  /* Footer */
  .footer {
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
    color: var(--muted);
    font-size: 14px;
    text-align: center;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
  }
  
  .footer-links {
    display: flex;
    gap: 16px;
  }
  
  .footer-links a {
    color: var(--muted);
    text-decoration: none;
    transition: var(--transition);
  }
  
  .footer-links a:hover {
    color: var(--accent);
  }
  
  /* Loader */
  .loader {
    width: 48px;
    height: 48px;
    border: 4px solid var(--border);
    border-radius: 50%;
    border-top-color: var(--accent);
    animation: spin 1s ease-in-out infinite;
    margin: 0 auto 16px;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  /* Scroll to top */
  .scroll-top {
    position: fixed;
    bottom: 24px;
    left: 24px;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--surface-card);
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    visibility: hidden;
    transition: var(--transition);
    z-index: 100;
    font-size: 20px;
  }
  
  .scroll-top.visible {
    opacity: 1;
    visibility: visible;
  }
  
  .scroll-top:hover {
    background: var(--accent);
    color: white;
    transform: translateY(-4px);
    box-shadow: var(--shadow2);
  }
  
  /* Responsive */
  @media (max-width: 1200px) {
    .dashboard {
      grid-template-columns: 1fr;
    }
  }
  
  @media (max-width: 768px) {
    .header {
      flex-direction: column;
      align-items: flex-start;
      gap: 20px;
    }
    
    .controls {
      width: 100%;
      overflow-x: auto;
      padding-bottom: 8px;
    }
    
    .card-grid {
      grid-template-columns: 1fr;
    }
    
    canvas#priceChart {
      height: 280px;
    }
    
    .footer {
      flex-direction: column;
      gap: 16px;
    }
  }
  
  /* Real-time indicator */
  .real-time-indicator {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(16, 185, 129, 0.15);
    color: var(--ok);
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    z-index: 1000;
  }
  
  .pulse {
    width: 10px;
    height: 10px;
    background: var(--ok);
    border-radius: 50%;
    animation: pulse 1.5s infinite;
  }
  
  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
    100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
  }
  
  /* Source badges */
  .source-badge {
    position: absolute;
    bottom: 10px;
    left: 10px;
    background: rgba(0, 0, 0, 0.4);
    color: var(--muted);
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 10px;
  }
</style>
</head>
<body>
<div class="wrap">
  <!-- Real-time indicator -->
  <div class="real-time-indicator">
    <div class="pulse"></div>
    <span>Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ©</span>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="logo-container">
      <div class="logo">
        <i class="fas fa-chart-line"></i>
      </div>
      <div class="logo-text">
        <h1 class="site-title">Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚</h1>
        <div class="site-subtitle">Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ© ÙˆÙ…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ÙˆØ«ÙˆÙ‚Ø©</div>
      </div>
    </div>
    
    <div class="controls">
      <div class="market-status">
        <div class="status-indicator active"></div>
        <div class="pill" id="marketScore">
          <i class="fas fa-chart-pie"></i>
          <span>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</span>
        </div>
      </div>
      
      <button class="btn" id="refreshBtn">
        <i class="fas fa-sync-alt"></i>
        <span>ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†</span>
      </button>
      
      <button class="btn" id="themeBtn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù…Ø©">
        <i class="fas fa-moon"></i>
        <span>Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
      </button>
    </div>
  </header>
  
  <!-- Chart Section -->
  <section class="chart-container">
    <div class="chart-header">
      <div class="chart-title">
        <i class="fas fa-bitcoin"></i>
        <span>Ø­Ø±ÙƒØ© Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† - 180 ÙŠÙˆÙ…Ø§Ù‹</span>
      </div>
      <div class="muted" id="asofChart">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
    <canvas id="priceChart" width="1200" height="380"></canvas>
    <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: CoinGecko API</div>
  </section>
  
  <!-- Data Cards -->
  <div class="card-grid">
    <!-- Bitcoin Price -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†</div>
        <div class="card-icon">
          <i class="fab fa-bitcoin"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="btcPrice">$--.--</div>
        <div class="kv">
          <span class="kv-label">Ø§Ù„ØªØºÙŠØ± (24 Ø³Ø§Ø¹Ø©)</span>
          <span class="kv-value" id="btcChange">--%</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: CoinGecko</div>
    </div>
    
    <!-- Market Cap -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
        <div class="card-icon">
          <i class="fas fa-globe"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="marketCap">$--.--</div>
        <div class="kv">
          <span class="kv-label">Ø§Ù„ØªØºÙŠØ± (24 Ø³Ø§Ø¹Ø©)</span>
          <span class="kv-value" id="marketCapChange">--%</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: CoinGecko</div>
    </div>
    
    <!-- Fear & Greed -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ ÙˆØ§Ù„Ø¬Ø´Ø¹</div>
        <div class="card-icon">
          <i class="fas fa-brain"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="fearGreedValue">--</div>
        <div class="kv">
          <span class="kv-label">Ø§Ù„Ø­Ø§Ù„Ø©</span>
          <span class="kv-value" id="fearGreedStatus">--</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: Alternative.me</div>
    </div>
    
    <!-- Hashrate -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ù‚ÙˆØ© Ø§Ù„Ø´Ø¨ÙƒØ© (Hashrate)</div>
        <div class="card-icon">
          <i class="fas fa-microchip"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="hashRate">-- EH/s</div>
        <div class="kv">
          <span class="kv-label">Ø§Ù„ØªØºÙŠØ± (7 Ø£ÙŠØ§Ù…)</span>
          <span class="kv-value" id="hashRateChange">--%</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: Blockchain.com</div>
    </div>
    
    <!-- Active Addresses -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø©</div>
        <div class="card-icon">
          <i class="fas fa-users"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="activeAddresses">--</div>
        <div class="kv">
          <span class="kv-label">Ø§Ù„ØªØºÙŠØ± (7 Ø£ÙŠØ§Ù…)</span>
          <span class="kv-value" id="addressesChange">--%</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: Blockchain.com</div>
    </div>
    
    <!-- Transaction Fees -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Ø±Ø³ÙˆÙ… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
        <div class="card-icon">
          <i class="fas fa-money-bill-wave"></i>
        </div>
      </div>
      <div class="card-content">
        <div class="big" id="transactionFees">$--.--</div>
        <div class="kv">
          <span class="kv-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø³ÙˆÙ…</span>
          <span class="kv-value" id="avgFee">$--.--</span>
        </div>
      </div>
      <div class="source-badge">Ø§Ù„Ù…ØµØ¯Ø±: Mempool.space</div>
    </div>
  </div>
  
  <!-- Footer -->
  <footer class="footer">
    <div class="footer-links">
      <a href="#"><i class="fas fa-info-circle"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</a>
      <a href="#"><i class="fas fa-history"></i> ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 60 Ø«Ø§Ù†ÙŠØ©</a>
    </div>
    <div class="copyright">
      <p id="asof">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
      <p>Â© 2023 Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø© ÙˆØ­ÙŠØ©</p>
    </div>
  </footer>
</div>

<div class="scroll-top" id="scrollTop">
  <i class="fas fa-arrow-up"></i>
</div>

<script>
// Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
const DATA_SOURCES = {
  BITCOIN_PRICE: "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true",
  MARKET_DATA: "https://api.coingecko.com/api/v3/global",
  FEAR_GREED: "https://api.alternative.me/fng/?limit=1",
  BLOCKCHAIN_STATS: "https://api.blockchain.info/stats",
  ACTIVE_ADDRESSES: "https://api.blockchain.info/charts/n-unique-addresses?timespan=60days&format=json",
  TRANSACTION_FEES: "https://mempool.space/api/v1/fees/recommended"
};

// Ø¹Ù†Ø§ØµØ± DOM
const elements = {
  btcPrice: document.getElementById('btcPrice'),
  btcChange: document.getElementById('btcChange'),
  marketCap: document.getElementById('marketCap'),
  marketCapChange: document.getElementById('marketCapChange'),
  fearGreedValue: document.getElementById('fearGreedValue'),
  fearGreedStatus: document.getElementById('fearGreedStatus'),
  hashRate: document.getElementById('hashRate'),
  hashRateChange: document.getElementById('hashRateChange'),
  activeAddresses: document.getElementById('activeAddresses'),
  addressesChange: document.getElementById('addressesChange'),
  transactionFees: document.getElementById('transactionFees'),
  avgFee: document.getElementById('avgFee'),
  asof: document.getElementById('asof'),
  asofChart: document.getElementById('asofChart'),
  marketScore: document.getElementById('marketScore'),
  refreshBtn: document.getElementById('refreshBtn'),
  themeBtn: document.getElementById('themeBtn'),
  scrollTop: document.getElementById('scrollTop')
};

// ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
function formatNumber(number) {
  if (number >= 1e12) return (number / 1e12).toFixed(2) + ' ØªØ±ÙŠÙ„ÙŠÙˆÙ†';
  if (number >= 1e9) return (number / 1e9).toFixed(2) + ' Ù…Ù„ÙŠØ§Ø±';
  if (number >= 1e6) return (number / 1e6).toFixed(2) + ' Ù…Ù„ÙŠÙˆÙ†';
  if (number >= 1e3) return (number / 1e3).toFixed(2) + ' Ø£Ù„Ù';
  return number.toFixed(2);
}

// Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©
async function fetchRealTimeData() {
  try {
    // Ø¬Ù„Ø¨ Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ÙˆØªØºÙŠØ±Ø§ØªÙ‡
    const btcResponse = await fetch(DATA_SOURCES.BITCOIN_PRICE);
    const btcData = await btcResponse.json();
    const btcPrice = btcData.bitcoin.usd;
    const btcChange = btcData.bitcoin.usd_24h_change;
    
    elements.btcPrice.textContent = `$${btcPrice.toLocaleString('en-US', {maximumFractionDigits: 2})}`;
    elements.btcChange.textContent = `${btcChange.toFixed(2)}%`;
    elements.btcChange.className = `kv-value trend ${btcChange >= 0 ? 'up' : 'down'}`;
    
    // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©
    const marketResponse = await fetch(DATA_SOURCES.MARKET_DATA);
    const marketData = await marketResponse.json();
    const marketCap = marketData.data.total_market_cap.usd;
    const marketCapChange = marketData.data.market_cap_change_percentage_24h_usd;
    
    elements.marketCap.textContent = `$${formatNumber(marketCap)}`;
    elements.marketCapChange.textContent = `${marketCapChange.toFixed(2)}%`;
    elements.marketCapChange.className = `kv-value trend ${marketCapChange >= 0 ? 'up' : 'down'}`;
    
    // Ø¬Ù„Ø¨ Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ ÙˆØ§Ù„Ø¬Ø´Ø¹
    const fearGreedResponse = await fetch(DATA_SOURCES.FEAR_GREED);
    const fearGreedData = await fearGreedResponse.json();
    const fearGreedValue = fearGreedData.data[0].value;
    const fearGreedStatus = fearGreedData.data[0].value_classification;
    
    elements.fearGreedValue.textContent = fearGreedValue;
    elements.fearGreedStatus.textContent = fearGreedStatus;
    
    // Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø¨ÙƒØ©
    const blockchainResponse = await fetch(DATA_SOURCES.BLOCKCHAIN_STATS);
    const blockchainData = await blockchainResponse.json();
    const hashRate = blockchainData.hash_rate / 1e18; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ EH/s
    
    elements.hashRate.textContent = `${hashRate.toFixed(2)} EH/s`;
    
    // Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø©
    const addressesResponse = await fetch(DATA_SOURCES.ACTIVE_ADDRESSES);
    const addressesData = await addressesResponse.json();
    const latestAddresses = addressesData.values[addressesData.values.length - 1].y;
    const prevAddresses = addressesData.values[addressesData.values.length - 8].y;
    const addressesChange = ((latestAddresses - prevAddresses) / prevAddresses) * 100;
    
    elements.activeAddresses.textContent = latestAddresses.toLocaleString();
    elements.addressesChange.textContent = `${addressesChange.toFixed(2)}%`;
    elements.addressesChange.className = `kv-value trend ${addressesChange >= 0 ? 'up' : 'down'}`;
    
    // Ø¬Ù„Ø¨ Ø±Ø³ÙˆÙ… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
    const feesResponse = await fetch(DATA_SOURCES.TRANSACTION_FEES);
    const feesData = await feesResponse.json();
    const avgFee = (feesData.halfHourFee + feesData.hourFee + feesData.fastestFee) / 3;
    const btcPriceResponse = await fetch('https://blockchain.info/ticker');
    const btcPriceData = await btcPriceResponse.json();
    const btcUsdPrice = btcPriceData.USD.last;
    const avgFeeUsd = (avgFee * 250 * btcUsdPrice) / 1e8; // ØªÙ‚Ø¯ÙŠØ± Ù„Ù„Ø±Ø³ÙˆÙ… Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±
    
    elements.transactionFees.textContent = `$${formatNumber(avgFeeUsd)}`;
    elements.avgFee.textContent = `$${avgFeeUsd.toFixed(2)}`;
    
    // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
    const now = new Date();
    elements.asof.textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${now.toLocaleTimeString()}`;
    elements.asofChart.textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${now.toLocaleTimeString()}`;
    
    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆÙ‚
    updateMarketScore(btcChange, marketCapChange, fearGreedValue);
    
  } catch (error) {
    console.error('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
    elements.marketScore.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`;
    elements.marketScore.className = "pill bad";
  }
}

// ØªØ­Ø¯ÙŠØ« ØªÙ‚ÙŠÙŠÙ… Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆÙ‚
function updateMarketScore(btcChange, marketCapChange, fearGreed) {
  let score = 50; // Ù…ØªÙˆØ³Ø·
  
  // ØªØ£Ø«ÙŠØ± ØªØºÙŠØ± Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†
  if (btcChange > 5) score += 20;
  else if (btcChange > 2) score += 10;
  else if (btcChange < -5) score -= 20;
  else if (btcChange < -2) score -= 10;
  
  // ØªØ£Ø«ÙŠØ± ØªØºÙŠØ± Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ©
  if (marketCapChange > 3) score += 15;
  else if (marketCapChange > 1) score += 7;
  else if (marketCapChange < -3) score -= 15;
  else if (marketCapChange < -1) score -= 7;
  
  // ØªØ£Ø«ÙŠØ± Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ ÙˆØ§Ù„Ø¬Ø´Ø¹
  const fgValue = parseInt(fearGreed);
  if (fgValue > 75) score -= 10; // Ø¬Ø´Ø¹ Ø´Ø¯ÙŠØ¯
  else if (fgValue > 55) score += 5; // Ø¬Ø´Ø¹
  else if (fgValue < 25) score += 10; // Ø®ÙˆÙ Ø´Ø¯ÙŠØ¯
  else if (fgValue < 45) score += 5; // Ø®ÙˆÙ
  
  // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø­Ø§Ù„Ø©
  let status, statusClass;
  if (score >= 75) {
    status = "ØµØ¹ÙˆØ¯ÙŠ Ù‚ÙˆÙŠ ğŸš€";
    statusClass = "ok";
  } else if (score >= 60) {
    status = "ØµØ¹ÙˆØ¯ÙŠ ğŸ‘";
    statusClass = "ok";
  } else if (score >= 40) {
    status = "Ù…Ø­Ø§ÙŠØ¯ â†”ï¸";
    statusClass = "";
  } else if (score >= 25) {
    status = "Ù‡Ø¨ÙˆØ·ÙŠ âš ï¸";
    statusClass = "warn";
  } else {
    status = "Ù‡Ø¨ÙˆØ·ÙŠ Ù‚ÙˆÙŠ ğŸ”»";
    statusClass = "bad";
  }
  
  elements.marketScore.innerHTML = `<i class="fas fa-chart-pie"></i> Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆÙ‚: ${status} (${score}/100)`;
  elements.marketScore.className = `pill ${statusClass}`;
}

// Ø±Ø³Ù… Ù…Ø®Ø·Ø· Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†
function drawBitcoinChart() {
  const canvas = document.getElementById('priceChart');
  const ctx = canvas.getContext('2d');
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù„Ù„Ø±Ø³Ù… Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ
  const data = [];
  let value = 25000;
  
  for (let i = 0; i < 180; i++) {
    value += (Math.random() - 0.5) * 1000;
    if (value < 20000) value = 20000 + Math.random() * 1000;
    if (value > 40000) value = 40000 - Math.random() * 1000;
    data.push(value);
  }
  
  const W = canvas.width;
  const H = canvas.height;
  const padding = 40;
  
  // Ù…Ø³Ø­ Ø§Ù„Ù„ÙˆØ­Ø©
  ctx.clearRect(0, 0, W, H);
  
  // Ø±Ø³Ù… Ø§Ù„Ø´Ø¨ÙƒØ©
  ctx.strokeStyle = "rgba(128, 128, 128, 0.2)";
  ctx.lineWidth = 1;
  ctx.beginPath();
  
  // Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø£ÙÙ‚ÙŠØ©
  for (let i = 0; i <= 5; i++) {
    const y = padding + i * (H - padding * 2) / 5;
    ctx.moveTo(padding, y);
    ctx.lineTo(W - padding, y);
  }
  
  // Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø±Ø£Ø³ÙŠØ©
  for (let i = 0; i <= 12; i++) {
    const x = padding + i * (W - padding * 2) / 12;
    ctx.moveTo(x, padding);
    ctx.lineTo(x, H - padding);
  }
  
  ctx.stroke();
  
  // Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù‚ØµÙˆÙ‰ ÙˆØ§Ù„Ø¯Ù†ÙŠØ§
  const maxVal = Math.max(...data);
  const minVal = Math.min(...data);
  const range = maxVal - minVal;
  
  // Ø±Ø³Ù… Ø§Ù„Ø®Ø·
  ctx.beginPath();
  ctx.strokeStyle = "#4f9cf9";
  ctx.lineWidth = 3;
  ctx.shadowColor = "#4f9cf9";
  ctx.shadowBlur = 15;
  
  data.forEach((val, i) => {
    const x = padding + i * (W - padding * 2) / (data.length - 1);
    const y = H - padding - ((val - minVal) / range) * (H - padding * 2);
    
    if (i === 0) {
      ctx.moveTo(x, y);
    } else {
      ctx.lineTo(x, y);
    }
  });
  
  ctx.stroke();
  ctx.shadowBlur = 0;
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ³Ù…ÙŠØ§Øª
  ctx.fillStyle = "#a8b3c0";
  ctx.font = "12px Tajawal";
  ctx.textAlign = "right";
  
  // Ø§Ù„Ù‚ÙŠÙ… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙˆØ± Y
  ctx.fillText(`$${Math.round(maxVal/1000)}K`, padding - 10, padding + 15);
  ctx.fillText(`$${Math.round(minVal/1000)}K`, padding - 10, H - padding + 15);
  
  // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø®Ø·Ø·
  ctx.fillStyle = "#f0f3f6";
  ctx.font = "bold 16px Tajawal";
  ctx.textAlign = "center";
  ctx.fillText("Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† (BTC/USD) - Ø¢Ø®Ø± 180 ÙŠÙˆÙ…Ø§Ù‹", W / 2, padding - 15);
}

// Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù…Ø©
function applyTheme(mode) {
  document.documentElement.setAttribute("data-theme", mode === "auto" ? "auto" : mode);
  localStorage.setItem("themeMode", mode);
  
  const themeText = mode === "light" ? "ÙØ§ØªØ­" : mode === "dark" ? "Ø¯Ø§ÙƒÙ†" : "ØªÙ„Ù‚Ø§Ø¦ÙŠ";
  elements.themeBtn.querySelector('span').textContent = `Ø§Ù„ÙˆØ¶Ø¹: ${themeText}`;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
  const icon = elements.themeBtn.querySelector('i');
  if (mode === "light") {
    icon.className = "fas fa-sun";
  } else if (mode === "dark") {
    icon.className = "fas fa-moon";
  } else {
    icon.className = "fas fa-adjust";
  }
}

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
function init() {
  // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø©
  const savedTheme = localStorage.getItem("themeMode") || "auto";
  applyTheme(savedTheme);
  
  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø²Ø± Ø§Ù„Ø³Ù…Ø©
  elements.themeBtn.addEventListener("click", () => {
    const order = ["auto", "light", "dark"];
    const currentIndex = order.indexOf(localStorage.getItem("themeMode") || "auto");
    const nextIndex = (currentIndex + 1) % order.length;
    applyTheme(order[nextIndex]);
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
  elements.refreshBtn.addEventListener("click", () => {
    elements.refreshBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...`;
    fetchRealTimeData();
    setTimeout(() => {
      elements.refreshBtn.innerHTML = `<i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†`;
    }, 2000);
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù„Ù‰
  window.addEventListener("scroll", () => {
    elements.scrollTop.classList.toggle("visible", window.scrollY > 300);
  });
  
  elements.scrollTop.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
  
  // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
  fetchRealTimeData();
  drawBitcoinChart();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 60 Ø«Ø§Ù†ÙŠØ©
  setInterval(fetchRealTimeData, 60000);
}

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
